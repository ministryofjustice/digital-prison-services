{% from "govuk/components/breadcrumbs/macro.njk" import govukBreadcrumbs %}

{% extends "govuk/template.njk" %}

{% block pageTitle %}{% if errors.length %}Error: {% endif %}{{title}} - Digital Prison Services{% endblock %}

{% block head %}
  {% if googleTagManagerId %}
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','{{ googleTagManagerId }}');</script>
    <!-- End Google Tag Manager -->
  {% endif %}

  {# Google Analytics: Universal Analytics (UA) - will be discontinued in July 2023 #}
  {% if googleAnalyticsId %}
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ googleAnalyticsId }}"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ googleAnalyticsId }}', { 'send_page_view': false }); // Avoid duplicate page view
    </script>
  {% endif %}

  {# Google Analytics: Google Analytics 4 (GA4) #}
  {% if googleAnalyticsGa4Id %}
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ googleAnalyticsGa4Id }}"></script>
    <script nonce="{{ cspNonce }}">
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '{{ googleAnalyticsGa4Id }}', { 'send_page_view': false }); // disable automatic page view tracking to avoid duplicates
    </script>
  {% endif %}


  <!--[if !IE 8]><!-->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js"
    integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
    crossorigin="anonymous"></script>

  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
    integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
    crossorigin="anonymous"></script>

  <link href = "https://code.jquery.com/ui/1.12.1/themes/ui-lightness/jquery-ui.css" rel = "stylesheet">
  <link href="/static/stylesheets/application.css" rel="stylesheet" />
  <link href="/static/styles/modal-dialog.css" rel="stylesheet" />
  <!--<![endif]-->

  {% block headIcons %}
      <link rel="shortcut icon" sizes="16x16 32x32 48x48" href="/static/favicon.ico" type="image/x-icon" />
  {% endblock %}
{% endblock %}

{% block bodyStart %}
  {% if googleTagManagerId %}
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id={{googleTagManagerId}}"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
  {% endif %}
{% endblock %}

{% block header %}
  {% include "./header.njk" %}
{% endblock %}

{% block footer %}
  {% include "./footer.njk" %}
{% endblock %}

{% block bodyEnd %}
{# Run JavaScript at end of the
<body>, to avoid blocking the initial render. #}
<script src="/static/js/modal-dialog.js"></script>
<script src="/assets/govuk/all.js"></script>
<script src="/static/js/main.js"></script>
<script>window.GOVUKFrontend.initAll();</script>
<script>var MOJFrontend = {};</script>
    {# Javascript block for individual pages #}
    {% block pageScripts %}
    {%  endblock %}
{% endblock %}
